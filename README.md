[![pypi badge](https://img.shields.io/pypi/v/embykeeper)](https://pypi.org/project/embykeeper/) [![downloads badge](https://img.shields.io/pypi/dm/embykeeper?color=%234287f5&label=downloads&logoColor=%234287f5)](https://pypi.org/project/embykeeper/) [![python versions badge](https://img.shields.io/pypi/pyversions/embykeeper)](https://pypi.org/project/embykeeper/) [![license badge](https://img.shields.io/github/license/embykeeper/embykeeper)](https://github.com/embykeeper/embykeeper/blob/main/LICENSE) [![telegram badge](https://img.shields.io/badge/telegram-bot-blue)](https://t.me/embykeeper_bot) [![telegram badge](https://img.shields.io/badge/telegram-channel-green)](https://t.me/embykeeper)

<p align="center">
  <a href='https://github.com/embykeeper/embykeeper'>
    <img src="https://github.com/embykeeper/embykeeper/blob/main/images/logo.svg" alt="Embykeeper" />
  </a>
</p>
<p align="center">
    <b>è‡ªåŠ¨ç­¾åˆ° å®šæ—¶ä¿å· æŒ‰éœ€æ°´ç¾¤</b>
</p>

---

Embykeeper æ˜¯ä¸€ä¸ªåœ¨ä¸­æ–‡ç¤¾ç¾¤è§„åˆ™ä¸‹ç”¨äº Emby å½±è§†æœåŠ¡å™¨çš„ç­¾åˆ°å’Œä¿å·çš„è‡ªåŠ¨æ‰§è¡Œå·¥å…·, åŸºäº Pyrogram ç¼–å†™å¹¶å…·æœ‰å¯æ‹“å±•æ€§.

## å£°æ˜

æœ¬é¡¹ç›®æ¶‰åŠçš„ä¸€åˆ‡ Emby æœåŠ¡å™¨ä¸ Embykeeper å¼€å‘å›¢é˜Ÿæ— å…³, åœ¨ä½¿ç”¨ Embykeeper æ—¶é€ æˆçš„ä¸€åˆ‡æŸå¤± (åŒ…æ‹¬ä½†ä¸é™äº Emby æˆ– Telegram è´¦å·è¢«å°ç¦æˆ–è¢«ç¾¤å°ç¦) ä¸å¼€å‘å›¢é˜Ÿæ— å…³. 

æœ¬é¡¹ç›®è®¾è®¡åˆè¡·æ˜¯åœ¨ä¸­æ–‡ Emby ç¤¾ç¾¤è§„åˆ™ä¸‹, ä¿å·è¦æ±‚é€æ¸è‹›åˆ» (éƒ¨åˆ†è¦æ±‚æ¯æœˆç™»å½•æˆ–æ¯æ—¥ç­¾åˆ°), è¿™ä½¿å¾—ä¼‘é—²æ—¶é—´ç´§å¼ çš„äººå£«éš¾ä»¥å®‰å¿ƒä½¿ç”¨. æœ¬é¡¹ç›®ä»…æ—¨åœ¨å¸®åŠ©è¯¥ç±»äººç¾¤ä¿å·, ä¸é¼“åŠ±æŒæœ‰å¤§é‡ Emby è´¦å·è€Œä¸ä½¿ç”¨, å¯¼è‡´çœŸæ­£éœ€è¦çš„äººã€ä¸ºä¸­æ–‡å½±è§†èµ„æºåˆ†äº«å’Œç¿»è¯‘æœ‰è´¡çŒ®çš„äººéš¾ä»¥è·å¾—è´¦å·çš„è¡Œä¸º, å¼€å‘å›¢é˜Ÿä¹Ÿå‘¼åä»…ä¿ç•™ 1-2 ä¸ªè¾ƒå…¨é¢è´¨é‡è¾ƒé«˜çš„ Emby æœåŠ¡å™¨. æœ¬é¡¹ç›®ä»…æä¾›å·¥å…·, å…·ä½“ä½¿ç”¨å½¢å¼åŠé€ æˆçš„å½±å“å’Œåæœä¸å¼€å‘å›¢é˜Ÿæ— å…³. 

æœ¬é¡¹ç›®æ¬¢è¿å‹å–„è®¨è®ºä¸å»ºè®®, æ‚¨å¯ä»¥é€šè¿‡ [Github Issue](https://github.com/embykeeper/embykeeper) é€”å¾„åé¦ˆ, å¹¶è®¤å¯å¼€å‘å›¢é˜Ÿå¯ä»¥å…³é—­ä¸é¡¹ç›®å¼€å‘ä¸ç›´æ¥ç›¸å…³çš„ä¸å‹å–„è®¨è®º. æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ [Telegram è®¨è®ºç»„](https://t.me/embykeeper_chat) ä¸å¼€å‘å›¢é˜Ÿè¿›è¡Œäº¤æµ.

å½“æ‚¨ä½¿ç”¨ "æ¶ˆæ¯æç¤º" åŠŸèƒ½, è¯¥å·¥å…·æ—¶å€™å°†è‡ªåŠ¨å‘ "[Embykeeper Auth Bot](https://t.me/embykeeper_auth_bot)" å‘é€å…³é”®çš„æˆåŠŸ/å¤±è´¥æ—¥å¿—ä»¥ä¾›ä» "[Embykeeper Bot](https://t.me/embykeeper_bot)" å‘æ‚¨æ¨é€, æ—¥å¿—å†…å®¹ä¸å«ä»»ä½•å¯†ç æˆ–å¯†é’¥ä¿¡æ¯, æ‚¨è®¤å¯è¯¥å‘½ä»¤ä¸ä¼šç»™æ‚¨å¸¦æ¥éšç§ä¸å®‰å…¨é—®é¢˜. 

å½“æ‚¨å®‰è£…å¹¶ä½¿ç”¨è¯¥å·¥å…·, é»˜è®¤æ‚¨å·²ç»é˜…è¯»å¹¶åŒæ„ä¸Šè¿°å£°æ˜, å¹¶ç¡®è®¤è‡ªå·±å¹¶éå‡ºäº"é›†é‚®"ç›®çš„è€Œå®‰è£…. 

## åŠŸèƒ½

- Telegram æœºå™¨äººç­¾åˆ°
  - æ”¯æŒç¾¤ç»„
    - ç»ˆç‚¹ç«™: [é¢‘é“](https://t.me/embypub) [ç¾¤ç»„](https://t.me/EmbyPublic) [æœºå™¨äºº](https://t.me/EmbyPublicBot)
    - å·æ¯›é¼ : [é¢‘é“]() [ç¾¤ç»„](https://t.me/Curly_Mouse) [æœºå™¨äºº](https://t.me/jmsembybot)
    - Nebula: [é¢‘é“](https://t.me/Nebula_Emby) [ç¾¤ç»„](https://t.me/NebulaEmbyUser) [æœºå™¨äºº](https://t.me/Nebula_Account_bot) (ç”±äºéœ€è¦ä»˜è´¹è·³è¿‡ Cloudflare éªŒè¯ç , éœ€è¦[é«˜çº§ç”¨æˆ·](https://t.me/embykeeper_bot?start=__prime))
    - BlueSea: [ç¾¤ç»„](https://t.me/blueseachat) [æœºå™¨äºº](https://t.me/blueseamusic_bot)
    - Singularity: [é¢‘é“](https://t.me/Singularity_Emby_Channel) [ç¾¤ç»„](https://t.me/Singularity_Emby_Group) [æœºå™¨äºº](https://t.me/Singularity_Emby_Bot)
    - Peach: [é¢‘é“](https://t.me/peach_emby_channel) [ç¾¤ç»„](https://t.me/peach_emby_chat) [æœºå™¨äºº](https://t.me/peach_emby_bot)
    - EmbyHub: [é¢‘é“](https://t.me/embyhub) [ç¾¤ç»„](https://t.me/emby_hub) [æœºå™¨äºº](https://t.me/EdHubot)
    - Pornemby (_æµ‹è¯•ä¸­_): [é¢‘é“](https://t.me/pornembyservice) [æœºå™¨äºº](https://t.me/PronembyTGBot2_bot)
    - å…¶ä»–é Emby ç›¸å…³:
      - æœä¹¦ç¥å™¨ ([@chneez](https://github.com/embykeeper/embykeeper/pull/8) å¢åŠ ) (_æµ‹è¯•ä¸­_)
    - é»˜è®¤ç¦ç”¨:
      - Pornemby ç§‘ä¸¾è€ƒè¯• (_æµ‹è¯•ä¸­_): [æ´»åŠ¨é¢‘é“](https://t.me/PornembyFun)
      - ~~å·æ¯›é¼  IPTV: [é¢‘é“](https://t.me/CurlyMouseIPTV) [ç¾¤ç»„](https://t.me/Curly_MouseIPTV) [æœºå™¨äºº](https://t.me/JMSIPTV_bot)~~ (æ— å“åº”)
      - ~~åƒåœ¾å½±éŸ³: [ç¾¤ç»„](https://t.me/+3sP2A-fgeXg0ZmY1) [æœºå™¨äºº](https://t.me/zckllflbot)~~ (æ— å“åº”)
  - ç‰¹æ€§
    - éªŒè¯ç è¯†åˆ«ä¸è‡ªåŠ¨é‡è¯•
    - å¤šè´¦æˆ·ç­¾åˆ°
    - ç½‘é¡µç±»å‹ç­¾åˆ°
- Emby ä¿æ´»
  - å®šæ—¶æ¨¡æ‹Ÿè´¦å·ç™»å½•è§†é¢‘æ’­æ”¾
  - æ’­æ”¾æ—¶é—´ä¸è¿›åº¦æ¨¡æ‹Ÿ
- Telegram è‡ªåŠ¨æ°´ç¾¤ (é»˜è®¤ä½¿ç”¨å†…å»ºè¯æœ¯åˆ—è¡¨, æ˜“è¢«è¾¨åˆ«å’Œå°ç¦, è¯·è°¨æ…ä½¿ç”¨)
  - NakoNako è‡ªåŠ¨æ°´ç¾¤: [ç¾¤ç»„](https://t.me/NakoNetwork) [æœºå™¨äºº](https://t.me/nakonetwork_bot)
- Telegram è‡ªåŠ¨ç›‘æ§ä¿¡æ¯ (éœ€è¦[è¶…çº§ç”¨æˆ·](https://t.me/embykeeper_bot?start=__prime))
  - ä¸ç»™çœ‹ æŠ¢é‚€è¯·ç : [ç¾¤ç»„](https://t.me/Ephemeralemby) [æœºå™¨äºº](https://t.me/UnknownEmbyBot)
  - Embyhub å¼€æ³¨è‡ªåŠ¨æ³¨å†Œ: [é¢‘é“](https://t.me/embyhub) [ç¾¤ç»„](https://t.me/emby_hub) [æœºå™¨äºº](https://t.me/EdHubot)

## å®‰è£…ä¸ä½¿ç”¨

### ä» Docker å®‰è£…

Embykeeper å¯ä»¥é€šè¿‡ `docker` è¿è¡Œ, æ‚¨éœ€[å®‰è£… docker](https://yeasy.gitbook.io/docker_practice/install), ç„¶åæ‰§è¡Œ:

```bash
touch config.toml
docker run -v $(pwd)/config.toml:/app/config.toml --rm -it embykeeper/embykeeper
```

å‘½ä»¤å°†ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆæ¨¡æ¿ `config.toml` æ–‡ä»¶, æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æœ€å°é…ç½® (ä»¥ä¸‹æ•æ„Ÿä¿¡æ¯ä¸ºç”Ÿæˆ, ä»…åšå‚è€ƒ):

```toml
[proxy]
hostname = "127.0.0.1"
port = "1080"
scheme = "socks5"

[[telegram]]
api_id = "27894236"
api_hash = "622159182fdd4b15b627eeb3ac695271"
phone = "+8612109347899"

[[emby]]
url = "https://weiss-griffin.com/"
username = "carrie19"
password = "s*D7MMCpS$"
```

å¯¹äº Telegram è€Œè¨€, æ‚¨å¯ä»¥é€šè¿‡ [Telegram å®˜ç½‘](https://my.telegram.org/) ç”³è¯· `api_id` å’Œ `api_hash`. ç™»é™†åé€‰æ‹© `API development tools`, éšååº”ç”¨ä¿¡æ¯å¯ä»¥éšæ„å¡«å†™, è¯·æ³¨æ„ `URL` æ˜¯å¿…å¡«é¡¹, å¯ä»¥å¡«å†™ `localhost`. æäº¤æ—¶è‹¥æ˜¾ç¤º "Error", æ‚¨å¯èƒ½éœ€è¦æ›´æ¢åº”ç”¨åç§°/çŸ­åç§°/ä»£ç†/æ¸…é™¤æµè§ˆå™¨è®°å½•å¹¶é‡è¯•.

éšå, æ‚¨éœ€è¦å†æ¬¡æ‰§è¡Œ:

```bash
docker run -v $(pwd)/config.toml:/app/config.toml --rm -it embykeeper/embykeeper
```

æ‚¨å°†è¢«è¯¢é—®è®¾å¤‡éªŒè¯ç ä»¥ç™»å½•, ç™»å½•æˆåŠŸå, Embykeeper å°†é¦–å…ˆæ‰§è¡Œä¸€æ¬¡ç­¾åˆ°å’Œä¿æ´», ç„¶åå¯åŠ¨ç¾¤ç»„ç›‘æ§å’Œæ°´ç¾¤è®¡åˆ’ä»»åŠ¡ (è‹¥å¯ç”¨).

æ­å–œæ‚¨ï¼æ‚¨å·²ç»æˆåŠŸéƒ¨ç½²äº† Embykeeper, ä¸ºäº†è®© Embykeeper é•¿æœŸåå°è¿è¡Œ, æ‚¨å¯ä»¥é€šè¿‡`Ctrl+C`åœæ­¢, ç„¶åè¿è¡Œ:

```bash
docker run -d -v $(pwd)/config.toml:/app/config.toml embykeeper/embykeeper
```

æˆ–è€…ä½¿ç”¨ [docker-compose](https://docs.docker.com/compose/) ([watchtower](https://github.com/containrrr/watchtower) è¢«ç”¨äºè‡ªåŠ¨æ›´æ–°å®¹å™¨æœåŠ¡):

```yaml
version: '3'
services:
  embykeeper:
    container_name: embykeeper
    image: cembykeeper/embykeeper
    restart: unless-stopped
    volumes:
      - ./config.toml:/app/config.toml
  watchtower:
    container_name: watchtower
    image: containrrr/watchtower
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:rw
```

å³å¯åœ¨åå°å¯åŠ¨ embykeeper.

æ‚¨å¯ä»¥é€šè¿‡ `docker logs -f embykeeper` æˆ– `docker-compose logs -f embykeeper` ä»¥æŸ¥çœ‹æœ€æ–°æ—¥å¿—.

å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨ä¸»æœºä¸Šçš„ä»£ç†æœåŠ¡å™¨ (ä¾‹å¦‚ `https://localhost:1080`), æ‚¨å¯èƒ½éœ€è¦ä½¿ç”¨ `--net=host` å‚æ•°ä»¥ä½¿ç”¨ä¸»æœºç½‘ç»œæ¨¡å¼.

### ä» Pypi å®‰è£…

Embykeeper éœ€è¦ Python ç¯å¢ƒä»¥è¿è¡Œ, æ‚¨å¯ä»¥é€šè¿‡ [conda](https://github.com/conda/conda) æˆ– [virtualvenv](https://virtualenv.pypa.io/) ç­‰å·¥å…·è¿›è¡Œç¯å¢ƒçš„ç®¡ç†.

æ‚¨å¯ä»¥é€šè¿‡ `pip` å®‰è£… `embykeeper` (éœ€è¦ `python >= 3.7, < 3.11`):

```bash
pip install embykeeper
```

éšå, æ‚¨éœ€è¦æ‰§è¡Œ:

```bash
embykeeper
```

å‘½ä»¤å°†ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆæ¨¡æ¿ `config.toml` æ–‡ä»¶, æ‚¨éœ€è¦ä¿®æ”¹æ‚¨çš„è´¦å·é…ç½® (è¯¦è§[ä» Docker å®‰è£…](https://github.com/embykeeper/embykeeper#%E4%BB%8E%20Docker%20%E5%AE%89%E8%A3%85)).

éšå, æ‚¨éœ€è¦å†æ¬¡æ‰§è¡Œ:

```bash
embykeeper
```

æ‚¨å°†è¢«è¯¢é—®è®¾å¤‡éªŒè¯ç ä»¥ç™»å½•, ç™»å½•æˆåŠŸå, Embykeeper å°†é¦–å…ˆæ‰§è¡Œä¸€æ¬¡ç­¾åˆ°å’Œä¿æ´», ç„¶åå¯åŠ¨ç¾¤ç»„ç›‘æ§å’Œæ°´ç¾¤è®¡åˆ’ä»»åŠ¡ (è‹¥å¯ç”¨).

æ­å–œæ‚¨ï¼æ‚¨å·²ç»æˆåŠŸéƒ¨ç½²äº† Embykeeper, ä¸ºäº†è®© Embykeeper é•¿æœŸåå°è¿è¡Œ, æ‚¨å¯ä»¥é€šè¿‡`Ctrl+C`åœæ­¢, ç„¶åè¿è¡Œ:

```bash
tmux
```

è¿™å°†å¯åŠ¨ä¸€ä¸ª `tmux` ç»ˆç«¯, æ‚¨å¯ä»¥åœ¨è¯¥ç»ˆç«¯ä¸­è¿è¡Œä¸Šè¿°å‘½ä»¤ (`embykeeper config.toml`), å¹¶æŒ‰ Ctrl + B, æ¾å¼€ B å†æŒ‰ D, ä»¥è„±ç¦» `tmux` ç»ˆç«¯. 

æ‚¨éšæ—¶å¯ä»¥é€šè¿‡è¿è¡Œ:

```bash
tmux a
```

ä»¥é‡æ–°è¿æ¥åˆ° `tmux` ç»ˆç«¯.

å½“ç‰ˆæœ¬æ›´æ–°æ—¶, æ‚¨éœ€è¦æ‰§è¡Œ:

```
pip install -U embykeeper
```

ç„¶åé‡æ–°è¿è¡Œåº”ç”¨.

### ä»æºç æ„å»º

é¦–å…ˆæ‹‰å– Github å¹¶å®‰è£…:

```bash
git clone https://github.com/embykeeper/embykeeper.git
cd embykeeper
make develop
```

ç„¶åå³å¯æ‰§è¡Œ Embykeeper:

```bash
embykeeper
```

è¯¦ç»†é…ç½®æ–¹æ³•è¯¦è§ [ä» Pypi å®‰è£…](https://github.com/embykeeper/embykeeper#%E4%BB%8E%20Pypi%20%E5%AE%89%E8%A3%85).

å½“ç‰ˆæœ¬æ›´æ–°æ—¶, æ‚¨éœ€è¦æ‰§è¡Œ:

```
git pull
```

ç„¶åé‡æ–°è¿è¡Œåº”ç”¨.

## å‘½ä»¤è¡Œå¸®åŠ©

æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ `embykeeper -h` ä»¥è·å–å¸®åŠ©:

```bash
$ embykeeper -h

æ¬¢è¿ä½¿ç”¨ Embykeeper. ğŸ¦ æ— å‚æ•°é»˜è®¤å¼€å¯å…¨éƒ¨åŠŸèƒ½.

å‚æ•°:
    config  é…ç½®æ–‡ä»¶ (ç½®ç©ºä»¥ç”Ÿæˆ)
æ¨¡å—å¼€å…³:
    --checkin     -c   å¯ç”¨æ¯æ—¥æŒ‡å®šæ—¶é—´ç­¾åˆ° (ä¸æŒ‡å®šå€¼æ—¶é»˜è®¤ä¸º6:00PM)
    --emby        -e   å¯ç”¨æ¯éš”å¤©æ•°Embyè‡ªåŠ¨ä¿æ´» (ä¸æŒ‡å®šå€¼æ—¶é»˜è®¤ä¸ºæ¯7å¤©)
    --monitor     -m   å¯ç”¨ç¾¤èŠç›‘è§†
    --send        -s   å¯ç”¨è‡ªåŠ¨æ°´ç¾¤
è°ƒè¯•å‚æ•°:
    --no-instant  -I   ä¸ç«‹åˆ»æ‰§è¡Œä¸€æ¬¡è®¡åˆ’ä»»åŠ¡
    --debug       -d   å¼€å¯è°ƒè¯•æ¨¡å¼, é”™è¯¯å°†ä¼šå¯¼è‡´ç¨‹åºåœæ­¢è¿è¡Œ
    --version     -v   æ‰“å° Embykeeper ç‰ˆæœ¬
    --follow      -f   ä»…å¯åŠ¨æ¶ˆæ¯è°ƒè¯•
    --analyze     -a   ä»…å¯åŠ¨å†å²ä¿¡æ¯åˆ†æ
```

ä¾‹å¦‚:

```bash
# ä»…å¯åŠ¨æ¯æ—¥ç­¾åˆ°
$ embykeeper config.toml -c

# ä»…å¯åŠ¨æ¯æ—¥ 8:00 PM ç­¾åˆ°
$ embykeeper config.toml -c 8:00PM

# å¯åŠ¨æ‰€æœ‰åŠŸèƒ½, åŒæ—¶è°ƒæ•´ç­¾åˆ°æ—¶é—´ä¸º 8:00 AM, è°ƒæ•´ä¿æ´»é—´éš”å¤©æ•°ä¸º 14
$ embykeeper config.toml -c 8:00PM -e 14 -m -s
```

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨é™„å¸¦çš„è°ƒè¯•å·¥å…·å¸®åŠ©æœ¬é¡¹ç›®çš„å¼€å‘, ä¾‹å¦‚å†å²è®°å½•åˆ†æå™¨:

```bash
# å¯åŠ¨å†å²ä¿¡æ¯åˆ†æ
$ embykeeper config.toml -a

è¯·è¾“å…¥ç¾¤ç»„ç”¨æˆ·å (ä»¥ç©ºæ ¼åˆ†éš”): https://t.me/XXX YYY 10253512
è¯·è¾“å…¥å…³é”®è¯ (ä»¥ç©ºæ ¼åˆ†éš”):
è¾“å…¥æ—¶é—´èŒƒå›´ (ä»¥"-"åˆ†å‰²): 8:00AM-10:00AM
è¯·è¾“å…¥å„ç¾¤ç»„æœ€å¤§è·å–æ•°é‡ [1000]:
```

è¯¥å‘½ä»¤ä¼šåˆ†æç‰¹å®šç¾¤ç»„çš„å†å²è®°å½•, ä»¥å¸®åŠ©æ‚¨æ’°å†™è‡ªåŠ¨æ°´ç¾¤å·¥å…·çš„è¯æœ¯åˆ—è¡¨.

å¦ä¸€ä¸ªå·¥å…·æ˜¯å³æ—¶ä¿¡æ¯åˆ†æ:

![follow screenshot](images/follow.svg)

è¯¥å·¥å…·å¯ä»¥å®æ—¶è¾“å‡ºæ¶ˆæ¯çš„ ID ç­‰ä¿¡æ¯, ä»¥æ–¹ä¾¿è°ƒè¯•.

## æ¶ˆæ¯æ¨é€ä¸é«˜çº§ç”¨æˆ·

æ‚¨å¯ä»¥é€šè¿‡è®¾ç½®é¡¹ "`notifier`" è®¾ç½® æˆåŠŸ/å¤±è´¥ é€šçŸ¥å°†è¢«å‘é€çš„ Telegram è´¦å·, æ‚¨å¯ä»¥é€šè¿‡ [Embykeeper Bot](https://t.me/embykeeper_bot) è®¾ç½®æ¶ˆæ¯æ¯æ—¥å‘é€çš„æ—¶é—´.

æœ¬é¡¹ç›®æ¶‰åŠçš„éœ€è¦ Cloudflare éªŒè¯ç ä»˜è´¹è·³è¿‡çš„æ“ä½œ (ä¾‹å¦‚ Nebula ç­¾åˆ°)ã€å¯èƒ½ä¼šå¼•èµ·ç«äº‰çš„æ“ä½œ (ä¾‹å¦‚è‡ªåŠ¨æŠ¢é‚€è¯·ç )å°†éœ€è¦é«˜çº§ç”¨æˆ·, æ‚¨å¯ä»¥é€šè¿‡ [Embykeeper Bot](https://t.me/embykeeper_bot?start=__prime) æˆä¸ºé«˜çº§ç”¨æˆ·.

ç›®å‰æœ‰ä¸‰ç§æ–¹å¼æˆä¸ºé«˜çº§ç”¨æˆ·:

1. åˆ†äº« 1 ä¸ªé‚€è¯·åˆ¶ Emby çš„é‚€è¯·ç ;
2. ä¸ºæœ¬é¡¹ç›®æä¾› [Pull Requests](https://github.com/embykeeper/embykeeper/pulls) å¹¶è¢«åˆå¹¶;
3. é€šè¿‡çˆ±å‘ç”µèµåŠ©ä¸€ä¸ª[å°åŒ…å­](https://afdian.net/a/jackzzs);

## æ”¯æŒ Embykeeper

##### å¼€å‘è€…å›¢é˜Ÿ

- [jackzzs](https://github.com/jackzzs)

##### é€šè¿‡[çˆ±å‘ç”µ](https://afdian.net/a/jackzzs)èµåŠ©

![kitty](images/kitty.gif)

## é…ç½®é¡¹

| è®¾ç½®é¡¹       | å€¼ç±»å‹             | ç®€ä»‹                                         | é»˜è®¤å€¼  |
| ------------ | ------------------ | -------------------------------------------- | ------- |
| `timeout`    | `int`              | Telegram æœºå™¨äººç­¾åˆ°è¶…æ—¶ (ç§’)                 | `120`   |
| `retries`    | `int`              | Telegram æœºå™¨äººç­¾åˆ°é”™è¯¯é‡è¯•æ¬¡æ•°              | `10`    |
| `concurrent` | `int`              | Telegram æœºå™¨äººç­¾åˆ°æœ€å¤§å¹¶å‘                  | `1`     |
| `random`     | `int`              | Telegram æœºå™¨äººç­¾åˆ°å®šæ—¶ä»»åŠ¡æ—¶é—´éšæœºé‡ (åˆ†é’Ÿ) | `15`    |
| `notifier`   | `int`/`bool`/`str` | å‘é€é€šçŸ¥åˆ° Telegram è´¦å· (åºå·/æ‰‹æœºå·)       | `False` |
| `service`    | `dict`             | ç­¾åˆ°/æ°´ç¾¤/ç›‘è§†åŠŸèƒ½å¼€å¯ç«™ç‚¹è®¾ç½®               | `{}`    |
| `proxy`      | `dict`             | ä»£ç†è®¾ç½®                                     | `{}`    |
| `telegram`   | `list`             | Telegram è´¦å·è®¾ç½® (æ”¯æŒå¤šè´¦å·)               | `[]`    |
| `emby`       | `list`             | Emby è´¦å·è®¾ç½® (æ”¯æŒå¤šè´¦å·)                   | `[]`    |

`service`è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹      | å€¼ç±»å‹ | ç®€ä»‹           | é»˜è®¤å€¼               |
| ----------- | ------ | -------------- | -------------------- |
| `checkiner` | `list` | å¯ç”¨çš„ç­¾åˆ°ç«™ç‚¹ | (å½“å‰æ‰€æœ‰æ”¯æŒçš„ç«™ç‚¹) |
| `monitor`   | `list` | å¯ç”¨çš„ç›‘è§†ä¼šè¯ | (å½“å‰æ‰€æœ‰æ”¯æŒçš„ä¼šè¯) |
| `messager`  | `list` | å¯ç”¨çš„æ°´ç¾¤ä¼šè¯ | (å½“å‰æ‰€æœ‰æ”¯æŒçš„ä¼šè¯) |

æ³¨æ„, å½“æ‚¨æœªæ›¾ä¸ç«™ç‚¹æœºå™¨äººå¯¹è¯, è¯¥ç«™ç‚¹ç­¾åˆ°å°†ä¸ä¼šè¿è¡Œ.
è‹¥æ‚¨éœ€è¦ç¦ç”¨éƒ¨åˆ†ç­¾åˆ°ç«™ç‚¹, æ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­åˆ é™¤å¯¹åº”çš„åç§°.
è‹¥æ‚¨éœ€è¦ä½¿ç”¨é»˜è®¤ç¦ç”¨çš„ç­¾åˆ°ç«™ç‚¹, æ‚¨å¯ä»¥åœ¨åˆ—è¡¨ä¸­å¢åŠ å¯¹åº”çš„åç§°.
å½“å‰æ”¯æŒçš„åç§°åŒ…æ‹¬:
| ç«™ç‚¹ | åç§° | | ç«™ç‚¹ | åç§° |
| --- | --- | --- |--- | --- |
| åƒåœ¾å½±éŸ³ | `ljyy` | | æœä¹¦ç¥å™¨ | `sosdbot` |
| å·æ¯›é¼  IPTV | `jms_iptv` | | ç»ˆç‚¹ç«™ | `terminus` |
| Pornemby | `pornemby` | | Singularity | `singularity` |
| Peach | `peach` | | Nebula | `nebula` |
| Bluesea | `bluesea` | | Embyhub | `embyhub` |
| å·æ¯›é¼  | `jms` | | | |

`proxy` è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹     | å€¼ç±»å‹ | ç®€ä»‹                                    | é»˜è®¤å€¼      |
| ---------- | ------ | --------------------------------------- | ----------- |
| `hostname` | `str`  | ä»£ç†æœåŠ¡å™¨åœ°å€                          | `localhost` |
| `port`     | `int`  | ä»£ç†ç«¯å£å·                              | `1080`      |
| `scheme`   | `str`  | ä»£ç†åè®®, å¯ä»¥ä¸º "`socks5`" æˆ– "`http`" | `socks5`    |

`telegram` è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹     | å€¼ç±»å‹ | ç®€ä»‹                                                               | é»˜è®¤å€¼  |
| ---------- | ------ | ------------------------------------------------------------------ | ------- |
| `api_id`   | `str`  | ä»[Telegram å®˜ç½‘](https://my.telegram.org/)ç”³è¯·çš„ Application ID   |         |
| `api_hash` | `str`  | ä»[Telegram å®˜ç½‘](https://my.telegram.org/)ç”³è¯·çš„ Application Hash |         |
| `phone`    | `str`  | è´¦æˆ·æ‰‹æœºå·, ä¸€èˆ¬ä¸º "`+86...`"                                      |         |
| `monitor`  | `bool` | å¯ç”¨ç¾¤ç»„ç›‘æ§ç³»åˆ—åŠŸèƒ½                                               | `false` |
| `send`     | `bool` | å¯ç”¨è‡ªåŠ¨æ°´ç¾¤ç³»åˆ—åŠŸèƒ½                                               | `false` |

`emby` è®¾ç½®å¯ä»¥ä¸º:

| è®¾ç½®é¡¹     | å€¼ç±»å‹ | ç®€ä»‹                                                      | é»˜è®¤å€¼ |
| ---------- | ------ | --------------------------------------------------------- | ------ |
| `url`      | `str`  | Emby æœåŠ¡å™¨åœ°å€, ä¸€èˆ¬ä¸º "`https://...`" æˆ– "`http://...`" |        |
| `username` | `str`  | Emby æœåŠ¡å™¨ç”¨æˆ·å                                         |        |
| `password` | `str`  | Emby æœåŠ¡å™¨å¯†ç                                            |        |
| `time`     | `int`  | æ¨¡æ‹Ÿè§‚çœ‹çš„æ—¶é—´ (ç§’)                                       | `800`  |
| `progress` | `int`  | è§‚çœ‹åæ¨¡æ‹Ÿè¿›åº¦æ¡ä¿å­˜çš„æ—¶é—´ (ç§’)                           | `1000` |

## ä»£ç é‡ç”¨ä¸å¼€å‘

ä»£ç æ¶æ„å¦‚ä¸‹:

```mermaid
flowchart TD
    A(fa:fa-terminal cli) --> B(fa:fa-telegram telechecker)
    A --> C(fa:fa-play embywatcher)
    B --checker--> E[fa:fa-robot Bot]
    B --monitor--> G[fa:fa-eye Monitor]
    B --messager--> F[fa:fa-message Messager]
    C --watcher--> H[fa:fa-circle-play EmbyWatcher]
    F ---- |schedule| A
```

ä¸»è¦å¯ä»¥æ‰©å±•çš„ç±»ä½äº:

- `embykeeper.telechecker.bots`
- `embykeeper.telechecker.monitor`
- `embykeeper.telechecker.messager`

é€šå¸¸æ¥è¯´, å¢åŠ ä¸€ä¸ªæœºå™¨äººçš„ç­¾åˆ°éå¸¸ç®€å•, æ‚¨éœ€è¦åœ¨ `bots` ä¸­å¢åŠ ä¸€ä¸ªæ–‡ä»¶ `dummy.py`:

```python
from .base import BotCheckin

class DummyCheckin(BotCheckin):
    name = "Dummy"
    bot_username = "dummy"
    bot_captcha_len = 4
```

æ‚¨å³å¢åŠ ä¸€ä¸ªåä¸º "`Dummy`" çš„ç­¾åˆ°å™¨, å°†ä¼šå‘ç”¨æˆ·åä¸º "`dummy`" çš„æœºå™¨äººå‘é€ "`/checkin`" å¹¶ç­‰å€™ä¸€ä¸ª 4 ä½çš„éªŒè¯ç , è¯†åˆ«éªŒè¯ç åå°†å‘é€.

è‹¥æ‚¨å¸Œæœ›è¯†åˆ«éªŒè¯ç åç‚¹å‡»æŒ‰é’®, æ‚¨å¯ä»¥ä½¿ç”¨ `AnswerBotCheckin`, æ‚¨ä¹Ÿå¯ä»¥é‡å†™ `on_captcha` å‡½æ•°æ¥å®ç°è‡ªå®šä¹‰åŠŸèƒ½:

```python
from .base import AnswerBotCheckin

class DummyCheckin(AnswerBotCheckin):
    ....
    async def on_captcha(self, message: Message, captcha: str):
        for l in captcha:
            try:
                await self.message.click(l)
            except ValueError:
                self.log.info(f'æœªèƒ½æ‰¾åˆ°å¯¹åº” "{l}" çš„æŒ‰é”®, æ­£åœ¨é‡è¯•.')
                await self.retry()
                break
```

ä¸Šè¿°ä»£ç å®ç°æ¯æ¬¡æŒ‰å¯¹åº”ä¸€ä¸ªå­—ç¬¦æŒ‰é”®çš„åŠŸèƒ½.

å½“æ‚¨å®ç°ä¸€ä¸ªæ–°çš„ç­¾åˆ°å™¨æ—¶, æ¬¢è¿æ‚¨æå‡º [Pull Requests](https://github.com/embykeeper/embykeeper/pulls) ä»¥å¸®åŠ©æ›´å¤šäººä½¿ç”¨!
